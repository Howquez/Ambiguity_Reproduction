subset = data,
subset_name = "full",
vars = model$vars,
covariates = model$covariates,
IV = model$IV,
response = model$response)
}
)
)
heterogeneity_full_list[[results]]
}
heterogeneity_full_list <- list()
for(iv in IVs){
models <- create_models(DVs, covariates_list, IV = iv)
# Run regressions and combine results
results <- rbindlist(lapply(models,
function(model) {
run_regression(formula = as.formula(model$formula),
subset = data,
subset_name = "full",
vars = model$vars,
covariates = model$covariates,
IV = model$IV,
response = model$response)
}
)
)
heterogeneity_full_list[[results]]
}
heterogeneity_full_list <- list()
for(iv in IVs){
models <- create_models(DVs, covariates_list, IV = iv)
# Run regressions and combine results
results <- rbindlist(lapply(models,
function(model) {
run_regression(formula = as.formula(model$formula),
subset = data,
subset_name = "full",
vars = model$vars,
covariates = model$covariates,
IV = model$IV,
response = model$response)
}
)
)
heterogeneity_full_list[results]
}
heterogeneity_full_list <- list()
for(iv in IVs){
models <- create_models(DVs, covariates_list, IV = iv)
# Run regressions and combine results
results <- rbindlist(lapply(models,
function(model) {
run_regression(formula = as.formula(model$formula),
subset = data,
subset_name = "full",
vars = model$vars,
covariates = model$covariates,
IV = model$IV,
response = model$response)
}
)
)
heterogeneity_full_list[[]] <- results
}
heterogeneity_full_list <- list()
for(iv in IVs){
models <- create_models(DVs, covariates_list, IV = iv)
# Run regressions and combine results
results <- rbindlist(lapply(models,
function(model) {
run_regression(formula = as.formula(model$formula),
subset = data,
subset_name = "full",
vars = model$vars,
covariates = model$covariates,
IV = model$IV,
response = model$response)
}
)
)
heterogeneity_full_list[] <- results
}
heterogeneity_full <- rbindlist(l = heterogeneity_full_list)
heterogeneity_full_list <- list()
for(iv in IVs){
models <- create_models(DVs, covariates_list, IV = iv)
# Run regressions and combine results
results <- rbindlist(lapply(models,
function(model) {
run_regression(formula = as.formula(model$formula),
subset = data,
subset_name = "full",
vars = model$vars,
covariates = model$covariates,
IV = model$IV,
response = model$response)
}
)
)
heterogeneity_full_list[[length(heterogeneity_full_list) + 1]] <- results
}
heterogeneity_full <- rbindlist(l = heterogeneity_full_list)
View(heterogeneity_full)
heterogeneity_full[, var_name := paste0(response, " ("ifelse(test = variable == "surpriseTRUE:treatedTRUE", yes = paste0("not ", variable), no = paste0(variable, " DDD"))]
heterogeneity_full[,
var_name := paste0(response,
" (",
ifelse(test = variable == "surpriseTRUE:treatedTRUE",
yes = paste0("not ", variable),
no = paste0(variable, " DDD")))]
View(heterogeneity_full)
heterogeneity_full[,
var_name := paste0(response,
" (",
ifelse(test = variable == "surpriseTRUE:treatedTRUE",
yes = paste0("not ", IV),
no = paste0(IV, " DDD")))]
View(heterogeneity_full)
heterogeneity_full[,
var_name := paste0(response,
" (",
ifelse(test = variable == "surpriseTRUE:treatedTRUE",
yes = paste0("not ", IV),
no = paste0(IV, " DDD")),
")")]
View(heterogeneity_full)
heterogeneity_full %>% head()
heterogeneity_full[covariates == 0,
controls := "1.) none"]
heterogeneity_full[covariates == 7,
controls := "2.) demographic"]
heterogeneity_full[covariates == 13,
controls := "3.) demographic + further"]
heterogeneity_full[, controls := factor(controls,
levels = c("3.) demographic + further",
"2.) demographic",
"1.) none"))]
heterogeneity_full %>% head(23)
heterogeneity_full[, y_label := paste0(response, " (", ifelse(grepl("_con", variable), sub("_con", " DDD", variable),
ifelse(grepl("surpriseTRUE:treatedTRUE", variable), paste("not", IV), IV)), ")")]
# Order the y_label factor levels
y_order <- c("a (not female)", "a (female DDD)", "b (not female)", "b (female DDD)",
"a (not high_accuracy)", "a (high_accuracy DDD)", "b (not high_accuracy)", "b (high_accuracy DDD)")
heterogeneity_full[, y_label := factor(y_label, levels = rev(y_order))]
# Create the plot
ggplot(heterogeneity_full, aes(y = y_label, x = estimate, xmin = conf.low, xmax = conf.high, shape = controls)) +
geom_pointrange(position = position_dodge(width = 0.4), fatten = 5, alpha = 0.8) +
geom_vline(xintercept = 0, color = "red", alpha = 0.2) +
scale_shape_manual(values = c("1.) none" = 15, "2.) demographic" = 16, "3.) demographic + further" = 17)) +
labs(y = "Ambiguity Index", x = "Estimate", shape = "Control variables") +
theme_bw() +
theme(
plot.title = element_text(face = "bold", size = 12),
legend.background = element_rect(fill = "white", size = 4, colour = "white"),
axis.ticks = element_line(colour = "grey90", size = 0.1),
panel.grid.major = element_line(colour = "grey90", size = 0.07),
panel.grid.minor = element_blank(),
legend.key.size = unit(1, "lines"),
legend.box = 'horizontal',
legend.position = "top"
)
heterogeneity_full[, y_label := paste0(response, " (", ifelse(grepl("_con", variable), sub("_con", " DDD", variable),
ifelse(grepl("surpriseTRUE:treatedTRUE", variable), paste("not", IV), IV)), ")")]
# Order the y_label factor levels
y_order <- c("a (not female)","a (female DDD)", "b (not female)", "b (female DDD)","a (less accurate)","a (accurate DDD)", "b (less accurate)", "b (accurate DDD)","a (less credible)","a (credible DDD)", "b (less credible)", "b (credible DDD)","a (less forecast usage)","a (forecast usage DDD)", "b (less forecast usage)", "b (forecast usage DDD)","a (lower temperature)","a (temperature DDD)", "b (lower temperature)", "b (temperature DDD)","a (lower education)","a (education DDD)", "b (lower education)", "b (education DDD)") )
heterogeneity_full[, y_label := paste0(response, " (", ifelse(grepl("_con", variable), sub("_con", " DDD", variable),
ifelse(grepl("surpriseTRUE:treatedTRUE", variable), paste("not", IV), IV)), ")")]
# Order the y_label factor levels
y_order <- c("a (not female)","a (female DDD)", "b (not female)", "b (female DDD)","a (less accurate)","a (accurate DDD)", "b (less accurate)", "b (accurate DDD)","a (less credible)","a (credible DDD)", "b (less credible)", "b (credible DDD)","a (less forecast usage)","a (forecast usage DDD)", "b (less forecast usage)", "b (forecast usage DDD)","a (lower temperature)","a (temperature DDD)", "b (lower temperature)", "b (temperature DDD)","a (lower education)","a (education DDD)", "b (lower education)", "b (education DDD)")
heterogeneity_full[, y_label := factor(y_label, levels = rev(y_order))]
# Create the plot
ggplot(heterogeneity_full, aes(y = y_label, x = estimate, xmin = conf.low, xmax = conf.high, shape = controls)) +
geom_pointrange(position = position_dodge(width = 0.4), fatten = 5, alpha = 0.8) +
geom_vline(xintercept = 0, color = "red", alpha = 0.2) +
scale_shape_manual(values = c("1.) none" = 15, "2.) demographic" = 16, "3.) demographic + further" = 17)) +
labs(y = "Ambiguity Index", x = "Estimate", shape = "Control variables") +
theme_bw() +
theme(
plot.title = element_text(face = "bold", size = 12),
legend.background = element_rect(fill = "white", size = 4, colour = "white"),
axis.ticks = element_line(colour = "grey90", size = 0.1),
panel.grid.major = element_line(colour = "grey90", size = 0.07),
panel.grid.minor = element_blank(),
legend.key.size = unit(1, "lines"),
legend.box = 'horizontal',
legend.position = "top"
)
# Create the plot
ggplot(data = heterogeneity_full,
mapping = aes(y = y_label,
x = estimate,
xmin = conf.low,
xmax = conf.high,
shape = controls)) +
geom_pointrange(position = position_dodge(width = 0.4), fatten = 5, alpha = 0.8) +
geom_vline(xintercept = 0, color = "red", alpha = 0.2) +
labs(y = "Ambiguity Index", x = "Estimate", shape = "Control variables") +
theme_bw() +
theme(
plot.title = element_text(face = "bold", size = 12),
legend.background = element_rect(fill = "white", size = 4, colour = "white"),
axis.ticks = element_line(colour = "grey90", size = 0.1),
panel.grid.major = element_line(colour = "grey90", size = 0.07),
panel.grid.minor = element_blank(),
legend.key.size = unit(1, "lines"),
legend.box = 'horizontal',
legend.position = "top"
)
heterogeneity_full_list <- list()
for(iv in IVs){
models <- create_models(DVs, covariates_list, IV = iv)
# Run regressions and combine results
results <- rbindlist(lapply(models,
function(model) {
run_regression(formula = as.formula(model$formula),
subset = data,
subset_name = "full",
vars = model$vars,
covariates = model$covariates,
IV = model$IV,
response = model$response)
}
)
)
heterogeneity_full_list[[length(heterogeneity_full_list) + 1]] <- results
}
heterogeneity_full <- rbindlist(l = heterogeneity_full_list)
heterogeneity_full[,
var_name := paste0(response,
" (",
ifelse(test = variable == "surpriseTRUE:treatedTRUE",
yes = paste0("not ", IV),
no = paste0(IV, " DDD")),
")")]
heterogeneity_full[covariates == 0,
controls := "1.) none"]
heterogeneity_full[covariates == 7,
controls := "2.) demographic"]
heterogeneity_full[covariates == 13,
controls := "3.) demographic + further"]
heterogeneity_full[, controls := factor(controls,
levels = c("3.) demographic + further",
"2.) demographic",
"1.) none"))]
# Order the y_label factor levels
y_order <- c("a (not female)","a (female DDD)", "b (not female)", "b (female DDD)","a (less accurate)","a (accurate DDD)", "b (less accurate)", "b (accurate DDD)","a (less credible)","a (credible DDD)", "b (less credible)", "b (credible DDD)","a (less forecast usage)","a (forecast usage DDD)", "b (less forecast usage)", "b (forecast usage DDD)","a (lower temperature)","a (temperature DDD)", "b (lower temperature)", "b (temperature DDD)","a (lower education)","a (education DDD)", "b (lower education)", "b (education DDD)")
# heterogeneity_full[, y_label := factor(y_label, levels = rev(y_order))]
# Create the plot
ggplot(data = heterogeneity_full,
mapping = aes(y = var_name,
x = estimate,
xmin = conf.low,
xmax = conf.high,
shape = controls)) +
geom_pointrange(position = position_dodge(width = 0.4), fatten = 5, alpha = 0.8) +
geom_vline(xintercept = 0, color = "red", alpha = 0.2) +
labs(y = "Ambiguity Index", x = "Estimate", shape = "Control variables") +
theme_bw() +
theme(
plot.title = element_text(face = "bold", size = 12),
legend.background = element_rect(fill = "white", size = 4, colour = "white"),
axis.ticks = element_line(colour = "grey90", size = 0.1),
panel.grid.major = element_line(colour = "grey90", size = 0.07),
panel.grid.minor = element_blank(),
legend.key.size = unit(1, "lines"),
legend.box = 'horizontal',
legend.position = "top"
)
# Order the y_label factor levels
y_order <- c("a (not female)","a (female DDD)", "b (not female)", "b (female DDD)","a (less accurate)","a (accurate DDD)", "b (less accurate)", "b (accurate DDD)","a (less credible)","a (credible DDD)", "b (less credible)", "b (credible DDD)","a (less forecast usage)","a (forecast usage DDD)", "b (less forecast usage)", "b (forecast usage DDD)","a (lower temperature)","a (temperature DDD)", "b (lower temperature)", "b (temperature DDD)","a (lower education)","a (education DDD)", "b (lower education)", "b (education DDD)")
heterogeneity_full[, y_label := factor(y_order, levels = rev(y_order))]
View(heterogeneity_full)
heterogeneity_full
y_order <- c(
"b (not high_usage)", "b (not high_temperature)", "b (not high_education)",
"b (not high_credibility)", "b (not high_accuracy)", "b (not female)",
"b (high_usage DDD)", "b (high_temperature DDD)", "b (high_education DDD)",
"b (high_credibility DDD)", "b (high_accuracy DDD)", "b (female DDD)",
"a (not high_usage)", "a (not high_temperature)", "a (not high_education)",
"a (not high_credibility)", "a (not high_accuracy)", "a (not female)",
"a (high_usage DDD)", "a (high_temperature DDD)", "a (high_education DDD)",
"a (high_credibility DDD)", "a (high_accuracy DDD)", "a (female DDD)"
)
heterogeneity_full[, var_name := factor(var_name, levels = rev(y_order))]
#| label: fig-C1a
#| fig-cap: "Heterogeneous treatment effects of regression equation (1) with dependent variables b and a. Estimators with 95% confidence intervals. The underlying standard errors (“HC1”) are clustered at the individual level and estimated with the R package sandwich (Zeileis, 2004; Zeileis et al., 2020)."
ggplot(data = heterogeneity_full,
mapping = aes(y = var_name,
x = estimate,
xmin = conf.low,
xmax = conf.high,
shape = controls)) +
geom_pointrange(position = position_dodge(width = 0.4), fatten = 5, alpha = 0.8) +
geom_vline(xintercept = 0, color = "red", alpha = 0.2) +
scale_shape_manual(values = c("1.) none" = 15, "2.) demographic" = 17, "3.) demographic + further" = 16)) +
labs(title = "(a) Effect of contradiction (relative to confirmation).",
y = "Ambiguity Index",
x = "Estimate",
shape = "Control variables") +
theme_bw() +
theme(
plot.title = element_text(face = "bold", size = 12),
legend.background = element_rect(fill = "white", size = 4, colour = "white"),
axis.ticks = element_line(colour = "grey90", size = 0.1),
panel.grid.major = element_line(colour = "grey90", size = 0.07),
panel.grid.minor = element_blank(),
legend.key.size = unit(1, "lines"),
legend.box = 'horizontal',
legend.position = "top"
)
heterogeneity_full_list <- list()
for(iv in IVs){
models <- create_models(DVs, covariates_list, IV = iv)
# Run regressions and combine results
results <- rbindlist(lapply(models,
function(model) {
run_regression(formula = as.formula(model$formula),
subset = data,
subset_name = "full",
vars = model$vars,
covariates = model$covariates,
IV = model$IV,
response = model$response)
}
)
)
heterogeneity_full_list[[length(heterogeneity_full_list) + 1]] <- results
}
heterogeneity_full <- rbindlist(l = heterogeneity_full_list)
heterogeneity_full[,
var_name := paste0(response,
" (",
ifelse(test = variable == "surpriseTRUE:treatedTRUE",
yes = paste0("not ", IV),
no = paste0(IV, " DDD")),
")")]
heterogeneity_full[covariates == 0,
controls := "1.) none"]
heterogeneity_full[covariates == 7,
controls := "2.) demographic"]
heterogeneity_full[covariates == 13,
controls := "3.) demographic + further"]
heterogeneity_full[, controls := factor(controls,
levels = c("3.) demographic + further",
"2.) demographic",
"1.) none"))]
y_order <- c(
"b (not high_usage)", "b (not high_temperature)", "b (not high_education)",
"b (not high_credibility)", "b (not high_accuracy)", "b (not female)",
"b (high_usage DDD)", "b (high_temperature DDD)", "b (high_education DDD)",
"b (high_credibility DDD)", "b (high_accuracy DDD)", "b (female DDD)",
"a (not high_usage)", "a (not high_temperature)", "a (not high_education)",
"a (not high_credibility)", "a (not high_accuracy)", "a (not female)",
"a (high_usage DDD)", "a (high_temperature DDD)", "a (high_education DDD)",
"a (high_credibility DDD)", "a (high_accuracy DDD)", "a (female DDD)"
)
heterogeneity_full[, var_name := factor(var_name, levels = rev(y_order))]
#| label: fig-C1a
#| fig-cap: "Heterogeneous treatment effects of regression equation (1) with dependent variables b and a. Estimators with 95% confidence intervals. The underlying standard errors (“HC1”) are clustered at the individual level and estimated with the R package sandwich (Zeileis, 2004; Zeileis et al., 2020)."
ggplot(data = heterogeneity_full,
mapping = aes(y = var_name,
x = estimate,
xmin = conf.low,
xmax = conf.high,
shape = controls)) +
geom_pointrange(position = position_dodge(width = 0.4), fatten = 5, alpha = 0.8) +
geom_vline(xintercept = 0, color = "red", alpha = 0.2) +
scale_shape_manual(values = c("1.) none" = 15, "2.) demographic" = 17, "3.) demographic + further" = 16)) +
labs(title = "(a) Effect of contradiction (relative to confirmation).",
y = "Ambiguity Index",
x = "Estimate",
shape = "Control variables") +
theme_bw() +
theme(
plot.title = element_text(face = "bold", size = 12),
legend.background = element_rect(fill = "white", size = 4, colour = "white"),
axis.ticks = element_line(colour = "grey90", size = 0.1),
panel.grid.major = element_line(colour = "grey90", size = 0.07),
panel.grid.minor = element_blank(),
legend.key.size = unit(1, "lines"),
legend.box = 'horizontal',
legend.position = "top"
)
y_order <- c(
"b (education DDD)", "b (lower education)",
"a (education DDD)", "a (lower education)",
"b (temperature DDD)", "b (lower temperature)",
"a (temperature DDD)", "a (lower temperature)",
"b (forecast usage DDD)", "b (less forecast usage)",
"a (forecast usage DDD)", "a (less forecast usage)",
"b (credible DDD)", "b (less credible)",
"a (credible DDD)", "a (less credible)",
"b (accurate DDD)", "b (less accurate)",
"a (accurate DDD)", "a (less accurate)",
"b (female DDD)", "b (not female)",
"a (female DDD)", "a (not female)"
)
# Update var_name to factor with the correct order
heterogeneity_full[, var_name := factor(var_name, levels = rev(y_order))]
#| label: fig-C1a
#| fig-cap: "Heterogeneous treatment effects of regression equation (1) with dependent variables b and a. Estimators with 95% confidence intervals. The underlying standard errors (“HC1”) are clustered at the individual level and estimated with the R package sandwich (Zeileis, 2004; Zeileis et al., 2020)."
ggplot(data = heterogeneity_full,
mapping = aes(y = var_name,
x = estimate,
xmin = conf.low,
xmax = conf.high,
shape = controls)) +
geom_pointrange(position = position_dodge(width = 0.4), fatten = 5, alpha = 0.8) +
geom_vline(xintercept = 0, color = "red", alpha = 0.2) +
scale_shape_manual(values = c("1.) none" = 15, "2.) demographic" = 17, "3.) demographic + further" = 16)) +
labs(title = "(a) Effect of contradiction (relative to confirmation).",
y = "Ambiguity Index",
x = "Estimate",
shape = "Control variables") +
theme_bw() +
theme(
plot.title = element_text(face = "bold", size = 12),
legend.background = element_rect(fill = "white", size = 4, colour = "white"),
axis.ticks = element_line(colour = "grey90", size = 0.1),
panel.grid.major = element_line(colour = "grey90", size = 0.07),
panel.grid.minor = element_blank(),
legend.key.size = unit(1, "lines"),
legend.box = 'horizontal',
legend.position = "top"
)
heterogeneity_full[,
var_name := paste0(response,
" (",
ifelse(test = variable == "surpriseTRUE:treatedTRUE",
yes = paste0("not ", IV),
no = paste0(IV, " DDD")),
")")]
heterogeneity_full[covariates == 0,
controls := "1.) none"]
heterogeneity_full[covariates == 7,
controls := "2.) demographic"]
heterogeneity_full[covariates == 13,
controls := "3.) demographic + further"]
heterogeneity_full[, controls := factor(controls,
levels = c("3.) demographic + further",
"2.) demographic",
"1.) none"))]
y_order <- c(
"b (education DDD)", "b (lower education)",
"a (education DDD)", "a (lower education)",
"b (temperature DDD)", "b (lower temperature)",
"a (temperature DDD)", "a (lower temperature)",
"b (forecast usage DDD)", "b (less forecast usage)",
"a (forecast usage DDD)", "a (less forecast usage)",
"b (credible DDD)", "b (less credible)",
"a (credible DDD)", "a (less credible)",
"b (accurate DDD)", "b (less accurate)",
"a (accurate DDD)", "a (less accurate)",
"b (female DDD)", "b (not female)",
"a (female DDD)", "a (not female)"
)
# Update var_name to factor with the correct order
# heterogeneity_full[, var_name := factor(var_name, levels = rev(y_order))]
#| label: fig-C1a
#| fig-cap: "Heterogeneous treatment effects of regression equation (1) with dependent variables b and a. Estimators with 95% confidence intervals. The underlying standard errors (“HC1”) are clustered at the individual level and estimated with the R package sandwich (Zeileis, 2004; Zeileis et al., 2020)."
ggplot(data = heterogeneity_full,
mapping = aes(y = var_name,
x = estimate,
xmin = conf.low,
xmax = conf.high,
shape = controls)) +
geom_pointrange(position = position_dodge(width = 0.4), fatten = 5, alpha = 0.8) +
geom_vline(xintercept = 0, color = "red", alpha = 0.2) +
scale_shape_manual(values = c("1.) none" = 15, "2.) demographic" = 17, "3.) demographic + further" = 16)) +
labs(title = "(a) Effect of contradiction (relative to confirmation).",
y = "Ambiguity Index",
x = "Estimate",
shape = "Control variables") +
theme_bw() +
theme(
plot.title = element_text(face = "bold", size = 12),
legend.background = element_rect(fill = "white", size = 4, colour = "white"),
axis.ticks = element_line(colour = "grey90", size = 0.1),
panel.grid.major = element_line(colour = "grey90", size = 0.07),
panel.grid.minor = element_blank(),
legend.key.size = unit(1, "lines"),
legend.box = 'horizontal',
legend.position = "top"
)
heterogeneity_full
ggplot(data = heterogeneity_full,
mapping = aes(y = var_name,
x = estimate,
xmin = conf.low,
xmax = conf.high,
shape = controls)) +
geom_pointrange(position = position_dodge(width = 0.4), fatten = 5, alpha = 0.8) +
geom_vline(xintercept = 0, color = "red", alpha = 0.2) +
scale_shape_manual(values = c("1.) none" = 15, "2.) demographic" = 17, "3.) demographic + further" = 16)) +
labs(title = "(a) Effect of contradiction (relative to confirmation).",
y = "Ambiguity Index",
x = "Estimate",
shape = "Control variables") +
theme_bw() +
theme(
plot.title = element_text(face = "bold", size = 12),
legend.background = element_rect(fill = "white", size = 4, colour = "white"),
axis.ticks = element_line(colour = "grey90", size = 0.1),
panel.grid.major = element_line(colour = "grey90", size = 0.07),
panel.grid.minor = element_blank(),
legend.key.size = unit(1, "lines"),
legend.box = 'horizontal',
legend.position = "top"
)
View(heterogeneity_full)
log(0)
